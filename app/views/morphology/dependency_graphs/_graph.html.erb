<div>
  <% if collection.any? %>
    <div class="tw-border-0 tw-mb-4 morphology-graph-index" data-controller="graph-settings">
      <div class="tw-bg-gray-100 tw-p-4 tw-rounded-t-lg">
        <div class="tw-flex tw-justify-between tw-items-center tw-flex-wrap tw-gap-4">
          <% if @verse_info %>
            <div>
              <div class="tw-flex tw-items-center tw-gap-2 tw-mb-1">
                <p class="tw-mb-0"><span class="tw-font-semibold">Verse:</span> <%= @verse_info[:verse_key] %></p>

                <% if @navigation[:prev_id] %>
                  <%= link_to morphology_dependency_graph_path(@navigation[:prev_id], locale: @locale), class: 'tw-px-2 tw-py-1 tw-bg-blue-500 tw-text-white tw-rounded tw-text-sm hover:tw-bg-blue-600', title: 'Previous' do %>
                    <i class="fa fa-chevron-left"></i>
                  <% end %>
                <% else %>
                  <span class="tw-px-2 tw-py-1 tw-bg-gray-400 tw-text-white tw-rounded tw-text-sm tw-cursor-not-allowed" title="No previous">
                    <i class="fa fa-chevron-left"></i>
                  </span>
                <% end %>

                <% if @navigation[:next_id] %>
                  <%= link_to morphology_dependency_graph_path(@navigation[:next_id], locale: @locale), class: 'tw-px-2 tw-py-1 tw-bg-blue-500 tw-text-white tw-rounded tw-text-sm hover:tw-bg-blue-600', title: 'Next' do %>
                    <i class="fa fa-chevron-right"></i>
                  <% end %>
                <% else %>
                  <span class="tw-px-2 tw-py-1 tw-bg-gray-400 tw-text-white tw-rounded tw-text-sm tw-cursor-not-allowed" title="No next">
                    <i class="fa fa-chevron-right"></i>
                  </span>
                <% end %>

                <%= form_with url: morphology_dependency_graph_path(@graph), method: :get, local: true, class: 'tw-flex tw-items-center tw-gap-2 tw-ml-3' do %>
                  <%= select_tag :locale,
                      options_for_select([['العربية', 'ar'], ['English', 'en'], ['Urdu', 'ur']], @locale || 'ar'),
                      class: 'tw-px-2 tw-py-1 tw-border tw-border-gray-300 tw-rounded tw-text-sm focus:tw-outline-none focus:tw-ring-1 focus:tw-ring-blue-500',
                      onchange: 'this.form.submit()' %>
                <% end %>
              </div>
              <p class="tw-mb-0 tw-text-sm"><span class="tw-font-semibold">Graph Number:</span> <%= @verse_info[:graph_number] %> of <%= @verse_info[:total_graphs] %></p>
            </div>
          <% end %>

          <div class="tw-text-sm">
            <p class="tw-mb-1"><span class="tw-font-semibold">Total Nodes:</span> <%= collection.count %></p>
            <p class="tw-mb-0">
              <span class="tw-font-semibold">Types:</span>
              Word: <%= collection.where(type: 'word').count %> |
              Reference: <%= collection.where(type: 'reference').count %> |
              Phrase: <%= collection.where(type: 'phrase').count %> |
              Elided: <%= collection.where(type: 'elided').count %>
            </p>
          </div>

          <div>
            <%= render "compare_button" %>

            <button type="button"
                    class="tw-px-3 tw-py-1.5 tw-bg-gray-600 tw-text-white tw-rounded tw-text-sm hover:tw-bg-gray-700"
                    data-action="click->graph-settings#showModal"
                    data-controller="tooltip"
                    title="Graph settings">
              <i class="fa fa-cog"></i>
            </button>

            <button type="button"
                    class="tw-px-3 tw-py-1.5 tw-bg-green-600 tw-text-white tw-rounded tw-text-sm hover:tw-bg-green-700"
                    onclick="document.getElementById('graphSplitterModal').classList.remove('tw-hidden'); document.body.style.overflow = 'hidden';"
                    data-controller="tooltip"
                    title="Split graph">
              <i class="fa fa-scissors"></i>
            </button>
            <%= link_to "<i class='fa fa-edit'></i>".html_safe, edit_morphology_dependency_graph_path(@graph, locale: @locale), class: 'tw-px-3 tw-py-1.5 tw-bg-black tw-text-white tw-rounded tw-text-sm hover:tw-bg-gray-800', data: { controller: 'tooltip' }, title: 'Edit graph' %>
          </div>
        </div>
      </div>

      <%= render "compare_content" %>

      <%= render 'graph_settings' %>

      <%= render 'graph_splitter_modal' %>
    </div>
  <% end %>
</div>

