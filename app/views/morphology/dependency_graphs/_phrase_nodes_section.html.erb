<%
  # Filter only phrase nodes
  phrase_nodes = presenter.nodes.select { |n| n.type == 'phrase' }
%>

<div class="edit-section" data-controller="graph-bulk-edit">
  <div class="tw-flex tw-justify-between tw-items-center tw-mb-3">
    <div class="tw-flex tw-items-center tw-gap-2">
      <h2 class="tw-mb-0">Phrase Nodes (<span class="phrase-node-count"><%= phrase_nodes.count %></span>)</h2>
      <button type="button" 
              class="tw-p-0 tw-text-gray-600 hover:tw-text-gray-800 tw-bg-transparent tw-border-0 tw-cursor-pointer"
              data-controller="popover"
              data-action="click->popover#toggle"
              data-bs-placement="right"
              title="What are Phrase Nodes?"
              data-bs-content="<div class='text-start'><p class='tw-mb-2 small'>Phrase nodes represent grammatical constituents that group multiple words or other phrases together (e.g., Noun Phrase, Verb Phrase). They help define the hierarchical structure of the sentence.</p><div class='tw-text-center'><img src='<%= image_path('morphology/phrase_node_diagram.png') %>' class='img-fluid rounded border' style='max-width: 250px;' alt='Phrase Node Diagram'></div></div>">
        <i class="fa fa-question-circle"></i>
      </button>
    </div>
    <%= button_tag type: 'button',
                   class: 'tw-px-3 tw-py-1.5 tw-text-sm tw-font-medium tw-bg-green-600 hover:tw-bg-green-700 tw-text-white tw-rounded tw-transition-colors',
                   title: 'Add new phrase node',
                   data: { action: 'click->graph-bulk-edit#addPhraseNode' } do %>
      <i class="fa fa-plus"></i> Add Phrase
    <% end %>
  </div>
  
  <div class="tw-overflow-x-auto">
    <table class="edit-table tw-table-fixed">
      <thead>
        <tr>
          <th class="tw-w-[60px]">ID</th>
          <th class="tw-w-[70px]">Number</th>
          <th class="tw-w-[100px]">POS</th>
          <th class="tw-w-[200px]">Source â†’ Target</th>
          <th class="tw-w-[80px]">Actions</th>
        </tr>
      </thead>
      <tbody id="phrase_nodes_tbody">
        <% phrase_nodes.each do |node| %>
          <%= render 'morphology/dependency_graphs/forms/phrase_node_row',
                     node: node,
                     presenter: presenter,
                     graph_id: graph_id %>
        <% end %>
      </tbody>
    </table>
  </div>
</div>
