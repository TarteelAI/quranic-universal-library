<%
  parts = ayah_key.to_s.strip.split(':')
  chapter_number = parts[0].to_i
  verse_number = parts[1].to_i
  graph = Morphology::DependencyGraph::Graph.for_verse(chapter_number, verse_number).ordered.first
%>

<div class="tw-my-4 tw-border tw-border-gray-200 tw-rounded tw-overflow-hidden">
  <div class="tw-flex tw-items-center tw-justify-between tw-gap-2 tw-px-4 tw-py-2 tw-bg-gray-50 tw-border-b tw-border-gray-200">
    <div class="tw-font-semibold tw-text-sm">Dependency graph â€” <%= ayah_key %></div>
    <div class="tw-flex tw-items-center tw-gap-2">
      <%= link_to 'Open tool', lookup_morphology_dependency_graphs_path(verse_key: ayah_key, locale: I18n.locale), class: 'tw-text-sm tw-text-blue-700 tw-underline' %>
    </div>
  </div>

  <% if graph.present? %>
    <div class="syntax-graph-container tw-bg-white tw-min-h-[260px] tw-max-h-[70vh] tw-overflow-auto"
         data-controller="syntax-graph"
         data-syntax-graph-url-value="<%= syntax_graph_morphology_dependency_graph_path(graph, locale: I18n.locale) %>">
      <div data-syntax-graph-target="container" class="tw-p-3 tw-text-sm tw-text-gray-500">Loading syntax graph...</div>
    </div>
  <% else %>
    <div class="tw-p-4 tw-text-sm tw-text-gray-600">
      No graph found for <%= ayah_key %>.
    </div>
  <% end %>
</div>

