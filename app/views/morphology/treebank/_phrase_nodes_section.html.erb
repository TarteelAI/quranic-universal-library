<%
  # Filter only phrase nodes
  phrase_nodes = presenter.nodes.select { |n| n.type == 'phrase' }
%>

<div class="edit-section" data-controller="graph-bulk-edit">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <div class="d-flex align-items-center gap-2">
      <h2 class="mb-0">Phrase Nodes (<span class="phrase-node-count"><%= phrase_nodes.count %></span>)</h2>
      <button type="button" 
              class="btn btn-link text-secondary p-0"
              data-controller="popover"
              data-bs-toggle="popover"
              data-bs-placement="right"
              title="What are Phrase Nodes?"
              data-bs-content="<div class='text-start'><p class='mb-2 small'>Phrase nodes represent grammatical constituents that group multiple words or other phrases together (e.g., Noun Phrase, Verb Phrase). They help define the hierarchical structure of the sentence.</p><div class='text-center'><img src='<%= image_path('morphology/phrase_node_diagram.png') %>' class='img-fluid rounded border' style='max-width: 250px;' alt='Phrase Node Diagram'></div></div>">
        <i class="fa fa-question-circle"></i>
      </button>
    </div>
    <%= button_tag type: 'button',
                   class: 'btn btn-success btn-sm',
                   title: 'Add new phrase node',
                   data: { action: 'click->graph-bulk-edit#addPhraseNode' } do %>
      <i class="fa fa-plus"></i> Add Phrase
    <% end %>
  </div>
  
  <div class="table-responsive">
    <table class="edit-table tw-table-fixed">
      <thead>
        <tr>
          <th class="tw-w-[60px]">ID</th>
          <th class="tw-w-[70px]">Number</th>
          <th class="tw-w-[100px]">POS</th>
          <th class="tw-w-[200px]">Source â†’ Target</th>
          <th class="tw-w-[80px]">Actions</th>
        </tr>
      </thead>
      <tbody id="phrase_nodes_tbody">
        <% phrase_nodes.each do |node| %>
          <%= render 'morphology/treebank/forms/phrase_node_row',
                     node: node,
                     presenter: presenter,
                     graph_id: graph_id %>
        <% end %>
      </tbody>
    </table>
  </div>
</div>
