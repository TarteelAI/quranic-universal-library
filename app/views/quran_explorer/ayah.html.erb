<div class="tw-min-h-screen tw-bg-gray-50">
  <div class="tw-max-w-7xl tw-mx-auto tw-px-4 tw-py-8">
    <!-- Breadcrumb -->
    <nav class="tw-mb-6">
      <%= link_to quran_explorer_path, class: "tw-text-blue-600 hover:tw-text-blue-800" do %>
        Explorer
      <% end %>
      <span class="tw-mx-2 tw-text-gray-400">/</span>
      <%= link_to quran_explorer_surah_path(@chapter.chapter_number), class: "tw-text-blue-600 hover:tw-text-blue-800" do %>
        <%= @chapter.name_simple %>
      <% end %>
      <span class="tw-mx-2 tw-text-gray-400">/</span>
      <span class="tw-text-gray-600">Verse <%= @verse.verse_number %></span>
    </nav>

    <!-- Header -->
    <div class="tw-bg-white tw-rounded-lg tw-shadow-md tw-p-8 tw-mb-8">
      <div class="tw-text-center tw-mb-6">
        <h1 class="tw-text-2xl tw-font-bold tw-text-gray-900 tw-mb-2">
          <%= @chapter.name_simple %> <%= @verse.verse_number %>
        </h1>
        <p class="tw-text-gray-600">
          Verse <%= @verse.verse_number %> of <%= @chapter.verses_count %> • 
          <%= @verse.words_count %> words
        </p>
      </div>

      <!-- Navigation -->
      <div class="tw-flex tw-justify-center tw-gap-4 tw-mb-6">
        <% if @verse.verse_number > 1 %>
          <%= link_to quran_explorer_ayah_path(@chapter.chapter_number, @verse.verse_number - 1), 
                      class: "tw-bg-gray-200 hover:tw-bg-gray-300 tw-px-4 tw-py-2 tw-rounded tw-text-sm tw-shadow-sm" do %>
            ← Previous Verse
          <% end %>
        <% end %>
        
        <%= link_to quran_explorer_surah_path(@chapter.chapter_number), 
                    class: "tw-bg-blue-600 hover:tw-bg-blue-700 tw-text-white tw-px-4 tw-py-2 tw-rounded tw-text-sm tw-shadow-sm" do %>
          Back to Surah
        <% end %>
        
        <% if @verse.verse_number < @chapter.verses_count %>
          <%= link_to quran_explorer_ayah_path(@chapter.chapter_number, @verse.verse_number + 1), 
                      class: "tw-bg-gray-200 hover:tw-bg-gray-300 tw-px-4 tw-py-2 tw-rounded tw-text-sm tw-shadow-sm" do %>
            Next Verse →
          <% end %>
        <% end %>
      </div>
    </div>

    <!-- Arabic Text -->
    <div class="tw-bg-white tw-rounded-lg tw-shadow-md tw-p-8 tw-mb-8">
      <h2 class="tw-text-xl tw-font-bold tw-text-gray-900 tw-mb-6">Arabic Text</h2>
      
      <!-- Different Scripts -->
      <div class="tw-space-y-6">
        <div>
          <h3 class="tw-text-sm tw-font-medium tw-text-gray-700 tw-mb-3">Uthmani Script</h3>
          <div class="tw-text-3xl tw-text-gray-900 tw-leading-relaxed tw-p-4 tw-bg-gray-50 tw-rounded-lg" dir="rtl">
            <%= @verse.text_uthmani %>
          </div>
        </div>
        
        <% if @verse.text_qpc_hafs.present? %>
          <div>
            <h3 class="tw-text-sm tw-font-medium tw-text-gray-700 tw-mb-3">QPC Hafs Script</h3>
            <div class="tw-text-3xl tw-text-gray-900 tw-leading-relaxed tw-p-4 tw-bg-gray-50 tw-rounded-lg" dir="rtl">
              <%= @verse.text_qpc_hafs %>
            </div>
          </div>
        <% end %>
        
        <% if @verse.text_indopak.present? %>
          <div>
            <h3 class="tw-text-sm tw-font-medium tw-text-gray-700 tw-mb-3">IndoPak Script</h3>
            <div class="tw-text-3xl tw-text-gray-900 tw-leading-relaxed tw-p-4 tw-bg-gray-50 tw-rounded-lg" dir="rtl">
              <%= @verse.text_indopak %>
            </div>
          </div>
        <% end %>
      </div>
    </div>

    <!-- Word-by-Word Analysis -->
    <div class="tw-bg-white tw-rounded-lg tw-shadow-md tw-p-8 tw-mb-8">
      <h2 class="tw-text-xl tw-font-bold tw-text-gray-900 tw-mb-6">Word-by-Word Analysis</h2>
      
      <div class="tw-grid tw-grid-cols-1 sm:tw-grid-cols-2 lg:tw-grid-cols-3 xl:tw-grid-cols-4 tw-gap-4">
        <% @words.each do |word| %>
          <%= link_to quran_explorer_word_path(@chapter.chapter_number, @verse.verse_number, word.position), 
                      class: "tw-block tw-p-4 tw-border tw-border-gray-200 tw-rounded-lg hover:tw-border-blue-500 hover:tw-shadow-md tw-transition-all tw-duration-200" do %>
            <div class="tw-text-center">
              <div class="tw-text-2xl tw-text-gray-900 tw-mb-2" dir="rtl">
                <%= word.text_uthmani %>
              </div>
              
              <% if word.en_translation %>
                <div class="tw-text-sm tw-text-gray-700 tw-mb-2">
                  <%= word.en_translation.text %>
                </div>
              <% end %>
              
              <div class="tw-text-xs tw-text-gray-500">
                Position <%= word.position %>
                <% if word.root %>
                  • Root: <%= word.root.value %>
                <% end %>
              </div>
            </div>
          <% end %>
        <% end %>
      </div>
    </div>

    <!-- Translations -->
    <% if @translations.any? %>
      <div class="tw-bg-white tw-rounded-lg tw-shadow-md tw-p-8 tw-mb-8">
        <h2 class="tw-text-xl tw-font-bold tw-text-gray-900 tw-mb-6">Translations</h2>
        
        <div class="tw-space-y-6">
          <% @translations.each do |translation| %>
            <div class="tw-border-l-4 tw-border-blue-500 tw-pl-6">
              <div class="tw-flex tw-items-center tw-justify-between tw-mb-2">
                <h3 class="tw-font-medium tw-text-gray-900">
                  <%= translation.language.name %>
                </h3>
                <span class="tw-text-sm tw-text-gray-500">
                  <%= translation.resource_content&.name %>
                </span>
              </div>
              <div class="tw-text-gray-700">
                <%= simple_format(translation.text) %>
              </div>
            </div>
          <% end %>
        </div>
      </div>
    <% end %>

    <!-- Tafsir -->
    <% if @tafsirs.any? %>
      <div class="tw-bg-white tw-rounded-lg tw-shadow-md tw-p-8 tw-mb-8">
        <h2 class="tw-text-xl tw-font-bold tw-text-gray-900 tw-mb-6">Tafsir (Commentary)</h2>
        
        <div class="tw-space-y-6">
          <% @tafsirs.each do |tafsir| %>
            <div class="tw-border-l-4 tw-border-green-500 tw-pl-6">
              <div class="tw-flex tw-items-center tw-justify-between tw-mb-2">
                <h3 class="tw-font-medium tw-text-gray-900">
                  <%= tafsir.resource_content&.name %>
                </h3>
                <span class="tw-text-sm tw-text-gray-500">
                  <%= tafsir.language.name %>
                </span>
              </div>
              <div class="tw-text-gray-700 prose tw-max-w-none">
                <%= raw(tafsir.text) %>
              </div>
            </div>
          <% end %>
        </div>
      </div>
    <% end %>

    <!-- Audio -->
    <% if @audio_files.any? %>
      <div class="tw-bg-white tw-rounded-lg tw-shadow-md tw-p-8 tw-mb-8">
        <h2 class="tw-text-xl tw-font-bold tw-text-gray-900 tw-mb-6">Audio Recitations</h2>
        
        <div class="tw-space-y-4">
          <% @audio_files.each do |audio| %>
            <div class="tw-border tw-border-gray-200 tw-rounded-lg tw-p-4">
              <div class="tw-flex tw-items-center tw-justify-between tw-mb-2">
                <h3 class="tw-font-medium tw-text-gray-900">
                  <%= audio.recitation.reciter_name %>
                </h3>
                <span class="tw-text-sm tw-text-gray-500">
                  <%= audio.recitation.style %>
                </span>
              </div>
              <% if audio.audio_url.present? %>
                <audio controls class="tw-w-full">
                  <source src="<%= audio.audio_url %>" type="audio/mpeg">
                  Your browser does not support the audio element.
                </audio>
              <% end %>
            </div>
          <% end %>
        </div>
      </div>
    <% end %>

    <!-- Grammar & Morphology -->
    <% if @morphology_words.any? %>
      <div class="tw-bg-white tw-rounded-lg tw-shadow-md tw-p-8">
        <h2 class="tw-text-xl tw-font-bold tw-text-gray-900 tw-mb-6">Grammar & Morphology</h2>
        
        <div class="tw-space-y-4">
          <% @morphology_words.each do |morph_word| %>
            <div class="tw-border tw-border-gray-200 tw-rounded-lg tw-p-4">
              <div class="tw-flex tw-items-center tw-gap-4 tw-mb-2">
                <div class="tw-text-lg tw-font-medium" dir="rtl">
                  <%= morph_word.text %>
                </div>
                <div class="tw-text-sm tw-text-gray-600">
                  Position <%= morph_word.position %>
                </div>
              </div>
              
              <% if morph_word.description.present? %>
                <div class="tw-text-gray-700 tw-mb-2">
                  <%= morph_word.description %>
                </div>
              <% end %>
              
              <% if morph_word.grammar_concepts.any? %>
                <div class="tw-flex tw-flex-wrap tw-gap-2">
                  <% morph_word.grammar_concepts.each do |concept| %>
                    <span class="tw-bg-purple-100 tw-text-purple-700 tw-px-2 tw-py-1 tw-rounded tw-text-xs">
                      <%= concept.description %>
                    </span>
                  <% end %>
                </div>
              <% end %>
            </div>
          <% end %>
        </div>
      </div>
    <% end %>
  </div>
</div>