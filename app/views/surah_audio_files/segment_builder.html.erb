<%= javascript_include_tag "segments/index", defer: true %>
<%= stylesheet_link_tag "segments/index", defer: true %>

<%
  actions = []
  if @audio_file.chapter_id > 1
    actions << link_to('Previous Surah', segment_builder_surah_audio_file_path(@audio_file.chapter_id - 1, recitation_id: @recitation.id), class: 'tw-px-4 tw-py-2 tw-text-sm tw-font-medium tw-bg-gray-900 tw-text-white tw-rounded tw-transition-colors hover:tw-bg-gray-800')
  end
  if @audio_file.chapter_id < 114
    actions << link_to('Next Surah', segment_builder_surah_audio_file_path(@audio_file.chapter_id + 1, recitation_id: @recitation.id), class: 'tw-px-4 tw-py-2 tw-text-sm tw-font-medium tw-bg-gray-900 tw-text-white tw-rounded tw-transition-colors hover:tw-bg-gray-800')
  end

  actions << link_to('Short keys', '#_', class: 'tw-px-4 tw-py-2 tw-text-sm tw-font-medium tw-bg-blue-600 tw-text-white tw-rounded tw-transition-colors hover:tw-bg-blue-700', data: { controller: 'ajax-modal', url: builder_help_surah_audio_files_path })
  actions << link_to('Back to Index', surah_audio_files_path(recitation_id: @recitation.id), class: 'tw-px-4 tw-py-2 tw-text-sm tw-font-medium tw-bg-blue-600 tw-text-white tw-rounded tw-transition-colors hover:tw-bg-blue-700')
%>

<%= render 'tools/header',
           name: 'Surah recitations',
           title: "Segment builder for #{@recitation.name}(#{@recitation.id})<div style='font-size: 0.5em'>Surah #{@audio_file.chapter.name_simple}</div>",
           key: 'surah_recitation_segment_builder',
           actions: actions
%>

<div class="page-wrapper tw-container tw-max-w-7xl tw-mx-auto tw-px-4 mt-0">
  <div class="page-section tw-mt-4">
    <div id="app"
         data-recitation="<%= @recitation.id %>"
         data-segment-locked="<%= @recitation.segment_locked? || !@access %>"
         data-chapter="<%= @audio_file.chapter_id %>"
         data-verses-count="<%= @audio_file.chapter.verses_count %>"
         data-verse="<%= params[:verse] %>"
         data-audio-type="chapter">
      <p>Loading</p>
    </div>
  </div>
</div>
